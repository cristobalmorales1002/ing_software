/* frontend/src/theme.css */

/* 1. MODO OSCURO (Por defecto) */
:root {
    --bg-main: #0b1219;
    --bg-card: #15202b;
    --bg-input: #0b1219;
    --text-main: #e0e6ed;
    --text-muted: #94a3b8;
    --border-color: #2c3e50;
    --accent-color: #4da8da; /* Tu Celeste Brillante */
    --sidebar-bg: linear-gradient(180deg, #0f1923 0%, #080c11 100%);
    --hover-bg: rgba(77, 168, 218, 0.1);
    --bg-form: #1e293b;

    /* Logo */
    --logo-bg: rgba(0, 0, 0, 0.2);
    --logo-border: rgba(255, 255, 255, 0.05);

    /* --- COLOR UNIFICADO DE ROL (Cyan #06b6d4) --- */
    --role-unified-bg: #06b6d4;
    --role-unified-text: #ffffff;    /* Letras blancas */

    /* Asignamos variables */
    --role-admin-bg: var(--role-unified-bg);
    --role-medico-bg: var(--role-unified-bg);
    --role-investigador-bg: var(--role-unified-bg);
    --role-estudiante-bg: var(--role-unified-bg);
    --role-visualizador-bg: var(--role-unified-bg);
    --role-text-color: var(--role-unified-text);
}

/* 2. MODO CLARO */
[data-theme="light"] {
    --bg-main: #f8f9fa;
    --bg-card: #ffffff;
    --bg-input: #ffffff;
    --text-main: #212529;
    --text-muted: #6c757d;
    --border-color: #dee2e6;
    --accent-color: #0d6efd;
    --sidebar-bg: linear-gradient(180deg, #ffffff 0%, #f1f3f5 100%);
    --hover-bg: rgba(13, 110, 253, 0.1);
    --bg-form: #ffffff;

    /* Logo */
    --logo-bg: #ffffff;
    --logo-border: #dee2e6;

    /* --- COLOR UNIFICADO (Igual al oscuro) --- */
    --role-unified-bg: #06b6d4;
    --role-unified-text: #ffffff;

    --role-admin-bg: var(--role-unified-bg);
    --role-medico-bg: var(--role-unified-bg);
    --role-investigador-bg: var(--role-unified-bg);
    --role-estudiante-bg: var(--role-unified-bg);
    --role-visualizador-bg: var(--role-unified-bg);
    --role-text-color: var(--role-unified-text);
}

/* Transiciones suaves */
body, .card, .sidebar, .form-control, table, .logo-container, .badge {
    transition: background-color 0.3s ease, color 0.3s ease, border-color 0.3s ease;
}

/* Switches */
[data-theme="dark"] .form-check-input:checked {
    background-color: var(--accent-color) !important;
    border-color: var(--accent-color) !important;
    background-image: url("data:image/svg+xml,%3csvg xmlns='http://www.w3.org/2000/svg' viewBox='-4 -4 8 8'%3e%3ccircle r='3' fill='%230b1219'/%3e%3c/svg%3e");
}

/* Checkboxes NO SELECCIONADOS en Modo Oscuro */
[data-theme="dark"] .form-check-input {
    background-color: var(--bg-input) !important;
    border-color: var(--text-muted) !important;
    opacity: 0.8;
}

/* --- FIX GLOBAL: TEXT-INFO en Modo Oscuro --- */
/* Esto arregla los títulos de "Opciones de Selección" y las Categorías del Formulario */
[data-theme="dark"] .text-info {
    color: var(--accent-color) !important; /* Forzamos tu celeste */
}

/* Listas en Modales */
.theme-option-list {
    background-color: var(--bg-form) !important;
    border: 1px solid var(--border-color) !important;
    border-radius: 6px;
    padding: 5px;
    max-height: 150px;
    overflow-y: auto;
}

.theme-option-list table,
.theme-option-list tbody,
.theme-option-list tr,
.theme-option-list td {
    background-color: transparent !important;
    color: var(--text-main) !important;
    border: none !important;
    --bs-table-bg: transparent !important;
    --bs-table-color: var(--text-main) !important;
    --bs-table-hover-bg: transparent !important;
}

/* --- CORRECCIÓN BOTONES Y LISTAS EN MODO OSCURO (Mensajes, Sidebar, etc) --- */

/* 1. Items de lista */
[data-theme="dark"] .list-group-item {
    background-color: var(--bg-card) !important;
    color: var(--text-main) !important;
    border-color: var(--border-color) !important;
}

/* 2. Hover en items de lista */
[data-theme="dark"] .list-group-item:hover {
    background-color: var(--hover-bg) !important;
    color: var(--text-main) !important;
}

/* 3. Item Activo (El seleccionado) */
[data-theme="dark"] .list-group-item.active {
    background-color: rgba(77, 168, 218, 0.2) !important; /* Fondo transparente suave */
    border-color: var(--accent-color) !important;
    color: var(--accent-color) !important; /* Texto celeste */
}

/* 4. Botones Primarios */
[data-theme="dark"] .btn-primary {
    background-color: var(--accent-color) !important;
    border-color: var(--accent-color) !important;
    color: #ffffff !important;
}

[data-theme="dark"] .btn-primary:hover {
    filter: brightness(1.1);
}

/* 5. Botones Outline */
[data-theme="dark"] .btn-outline-secondary {
    color: var(--text-muted) !important;
    border-color: var(--border-color) !important;
}

[data-theme="dark"] .btn-outline-secondary:hover {
    background-color: var(--border-color) !important;
    color: var(--text-main) !important;
}

/* ==========================================================================
   CORRECCIÓN DEFINITIVA: ACORDEONES (MODO OSCURO)
   ========================================================================== */

/* 1. Estado Base (Cerrado) */
[data-theme="dark"] .accordion-button {
    background-color: rgba(255, 255, 255, 0.1) !important;
    border: 1px solid var(--border-color) !important;
    color: var(--accent-color) !important; /* AHORA EL TEXTO ES CELESTE SIEMPRE */
    box-shadow: none !important;
    border-radius: 6px !important;
    margin-bottom: 0.5rem;
}

/* Forzar que los elementos internos (iconos, spans muted) también sean celestes */
[data-theme="dark"] .accordion-button span,
[data-theme="dark"] .accordion-button svg,
[data-theme="dark"] .accordion-button .text-muted {
    color: var(--accent-color) !important;
}

/* 2. Estado ABIERTO */
[data-theme="dark"] .accordion-button:not(.collapsed) {
    background-color: rgba(77, 168, 218, 0.15) !important;
    color: var(--accent-color) !important;
    box-shadow: inset 0 -1px 0 var(--border-color) !important;
}

/* 3. Flecha (Icono) - AHORA ES CELESTE */
[data-theme="dark"] .accordion-button::after {
    filter: none !important; /* Quitamos el invert */
    /* Usamos el SVG original de Bootstrap pero cambiamos fill='%234da8da' (Tu celeste) */
    background-image: url("data:image/svg+xml,%3csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 16 16' fill='%234da8da'%3e%3cpath fill-rule='evenodd' d='M1.646 4.646a.5.5 0 0 1 .708 0L8 10.293l5.646-5.647a.5.5 0 0 1 .708.708l-6 6a.5.5 0 0 1-.708 0l-6-6a.5.5 0 0 1 0-.708z'/%3e%3c/svg%3e") !important;
}

/* 4. Fix contenedor padre */
[data-theme="dark"] .accordion-item {
    border: none !important;
    background-color: transparent !important;
}

/* ==========================================================================
   NUEVO: Estilo "Botón" para Acordeones en Formularios (Modo CLARO)
   ========================================================================== */

/* 1. Estilo General */
[data-theme="light"] .accordion-button {
    border: 1px solid var(--border-color) !important;
    border-radius: 6px !important;
    color: var(--text-main) !important;
    box-shadow: none !important;
    padding: 0.75rem 1rem;
    margin-bottom: 0.5rem;
}

/* 2. Estilo cuando está ABIERTO */
[data-theme="light"] .accordion-button:not(.collapsed) {
    background-color: #e8f0fe !important;
    color: var(--accent-color) !important;
    border-color: var(--accent-color) !important;
}

/* 3. Estilo cuando está CERRADO */
[data-theme="light"] .accordion-button.collapsed {
    background-color: #f8f9fa !important;
    color: var(--text-main) !important;
}

/* 4. Fix contenedor padre */
[data-theme="light"] .accordion-item {
    border: none !important;
    background-color: transparent !important;
}

/* ==========================================================================
   NUEVO: Estilos para Pestañas (Tabs) en Modo Oscuro y Claro
   ========================================================================== */

/* --- MODO OSCURO --- */

[data-theme="dark"] .nav-tabs {
    border-bottom-color: var(--border-color) !important;
}

[data-theme="dark"] .nav-tabs .nav-link {
    color: var(--text-muted) !important;
    background-color: transparent !important;
    border: 1px solid transparent;
}

[data-theme="dark"] .nav-tabs .nav-link:hover {
    color: var(--text-main) !important;
    background-color: var(--hover-bg) !important;
    border-color: transparent;
}

[data-theme="dark"] .nav-tabs .nav-link.active {
    color: var(--accent-color) !important;
    background-color: rgba(77, 168, 218, 0.15) !important;
    border-color: var(--accent-color) var(--accent-color) transparent !important;
}

/* --- MODO CLARO --- */

[data-theme="light"] .nav-tabs .nav-link.active {
    color: var(--accent-color) !important;
    font-weight: 600;
}

/* ==========================================================================
   CORRECCIÓN ESPECÍFICA: Switches apagados en Dashboard (Modo Oscuro)
   ========================================================================== */

/* Fondo del riel cuando está APAGADO en modo oscuro */
[data-theme="dark"] .offcanvas-body .form-check-input:not(:checked) {
    background-color: #94a3b8 !important; /* Gris azulado medio (visible pero apagado) */
    border-color: #64748b !important;     /* Borde un poco más oscuro para definir */

    /* Pelotita: Azul marino oscuro (casi negro) para contraste fuerte */
    background-image: url("data:image/svg+xml,%3csvg xmlns='http://www.w3.org/2000/svg' viewBox='-4 -4 8 8'%3e%3ccircle r='3' fill='%230f172a'/%3e%3c/svg%3e") !important;
}

/* Hover suave cuando está apagado */
[data-theme="dark"] .offcanvas-body .form-check-input:not(:checked):hover {
    background-color: #cbd5e1 !important; /* Se ilumina un poco el gris al pasar el mouse */
}

/* --- Badge de Preguntas (Estilo UNIFICADO) --- */
.badge-preguntas {
    /* Fondo CELESTE para ambos modos */
    background-color: #4da8da !important;

    /* Configuración para que sea un círculo perfecto */
    width: 28px;
    height: 28px;
    border-radius: 50%;

    /* Centrado del número */
    display: inline-flex !important;
    align-items: center !important;
    justify-content: center !important;

    /* Ajustes de texto */
    font-size: 0.85rem;
    font-weight: 700;
    padding: 0 !important; /* Quitamos padding extra */
}

[data-theme="dark"] .accordion-button .badge-preguntas,
[data-theme="dark"] .badge-preguntas,
[data-theme="light"] .badge-preguntas {
    color: #ffffff !important; /* BLANCO PURO */
    -webkit-text-fill-color: #ffffff !important; /* Refuerzo para navegadores webkit */
}

[data-theme="light"] .accordion-button .text-info {
    color: #4da8da !important;
}
.accordion-button .text-info {
    color: #4da8da !important; /* El mismo "celestito" del círculo */
}